<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% if page.title %}{{ page.title }} · {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ site.description }}" />
    <link rel="stylesheet" href="{{ "/assets/style.css" | relative_url }}" />
  </head>
  <body>
    <header>
      <div class="header-inner">
        <div class="site-title"><a href="{{ "/" | relative_url }}">{{ site.title }}</a></div>
        <nav>
          <a href="{{ "/" | relative_url }}">Home</a>
          <a href="{{ "/news/" | relative_url }}">News</a>
          <a href="{{ "/publications/" | relative_url }}">Publications</a>
          <a href="{{ "/teaching-supervision/" | relative_url }}">Teaching</a>
          <a href="{{ "/professional-activities/" | relative_url }}">Service</a>
          <a href="{{ "/miscellaneous/" | relative_url }}">Misc</a>
        </nav>
      </div>
    </header>

    <main class="container">
      {{ content }}
    </main>

    <footer>
      <div class="footer-inner small">
        <div>© {{ "now" | date: "%Y" }} {{ site.title }}</div>
        <div>Hosted on GitHub Pages</div>
      </div>
    </footer>

    {% if page.url contains '/publications' %}
    <script>
      // Bold author name in both formats: "Taotao Cai" and "Cai, Taotao".
      (function () {
        // 1) Bold author name in both formats.
        const targets = document.querySelectorAll('.authors');
        for (const el of targets) {
          let html = el.innerHTML;
          // protect already-bolded occurrences
          html = html.replaceAll('<strong>Taotao Cai</strong>', '%%BOLD_TAOTAO_CAI%%');
          html = html.replaceAll('<strong>Cai, Taotao</strong>', '%%BOLD_CAI_TAOTAO%%');

          // replace remaining plain occurrences
          html = html.replaceAll('Taotao Cai', '<strong>Taotao Cai</strong>');
          html = html.replaceAll('Cai, Taotao', '<strong>Cai, Taotao</strong>');

          // restore protected
          html = html.replaceAll('%%BOLD_TAOTAO_CAI%%', '<strong>Taotao Cai</strong>');
          html = html.replaceAll('%%BOLD_CAI_TAOTAO%%', '<strong>Cai, Taotao</strong>');

          el.innerHTML = html;
        }

        // 2) Highlight CORE/CCF tags inside venue text.
        const venueEls = document.querySelectorAll('.venue');
        for (const el of venueEls) {
          let html = el.innerHTML;
          // CORE A* / A
          html = html.replace(/\(\s*CORE\s*([^\)]*)\)/gi, function (m, inner) {
            return '(<span class="badge core">CORE ' + inner.trim() + '</span>)';
          });
          // CCF-A / B / C (and variants like CCF A)
          html = html.replace(/\(\s*CCF\s*[-\s]*([ABC])\s*\)/gi, function (m, grade) {
            return '(<span class="badge ccf">CCF-' + grade.toUpperCase() + '</span>)';
          });
          html = html.replace(/\(\s*CCF\s*([ABC])\s*\)/gi, function (m, grade) {
            return '(<span class="badge ccf">CCF-' + grade.toUpperCase() + '</span>)';
          });

          el.innerHTML = html;
        }
      })();
    </script>
    {% endif %}
  </body>
</html>
